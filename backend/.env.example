APP_NAME=MoRius API
DEBUG=true
APP_MODE=gateway
# true: run schema/bootstrap checks on startup (recommended for gateway/monolith)
# false: skip bootstrap work in leaf services (auth/story/payments)
DB_BOOTSTRAP_ON_STARTUP=true
APP_GZIP_ENABLED=true
APP_GZIP_MINIMUM_SIZE=1024
APP_TRUST_PROXY_HEADERS=true
APP_FORWARDED_ALLOW_IPS=*
APP_ALLOWED_HOSTS=*
# For Render: use Render Postgres (recommended) or sqlite on a persistent disk.
# Example sqlite URL for Render disk mounted at /var/data:
# DATABASE_URL=sqlite:////var/data/morius.db
DATABASE_URL=sqlite:///./data/morius.db
# If not set, defaults are APP_MODE-aware:
# gateway/monolith=20, story=16, auth=8, payments=8
DB_POOL_SIZE=20
# If not set, defaults are APP_MODE-aware:
# gateway/monolith=40, story=24, auth=12, payments=12
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT_SECONDS=30
DB_POOL_RECYCLE_SECONDS=1800
DB_POOL_PRE_PING=true
SQLITE_BUSY_TIMEOUT_MS=10000
SQLITE_ENABLE_WAL=true
HTTP_POOL_CONNECTIONS=32
HTTP_POOL_MAXSIZE=64
# If not set, defaults are APP_MODE-aware:
# gateway/monolith=2, story=2, auth=1, payments=1
WEB_CONCURRENCY=1
# Uvicorn tuning for high-load environments
# Maximum number of pending TCP connections in the kernel accept queue
UVICORN_BACKLOG=2048
# Keep-alive timeout (seconds) for idle HTTP connections
UVICORN_TIMEOUT_KEEP_ALIVE=5
# Graceful shutdown timeout (seconds)
UVICORN_TIMEOUT_GRACEFUL_SHUTDOWN=30
# Optional hard cap on concurrent requests per worker (empty = unlimited)
UVICORN_LIMIT_CONCURRENCY=
# Log level: critical|error|warning|info|debug|trace
UVICORN_LOG_LEVEL=info
# Access logs can be disabled on very high traffic to reduce overhead
UVICORN_ACCESS_LOG=true
JWT_SECRET_KEY=change_this_secret_for_production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_TTL_MINUTES=10080
CORS_ORIGINS=http://localhost:5173,https://mo-rius.vercel.app
CORS_ORIGIN_REGEX=^https?://(localhost|127\\.0\\.0\\.1)(:\\d+)?$|^https://mo-rius(?:-[a-z0-9-]+)?\\.vercel\\.app$
GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
EMAIL_VERIFICATION_CODE_TTL_MINUTES=10
EMAIL_VERIFICATION_MAX_ATTEMPTS=5
EMAIL_VERIFICATION_RESEND_COOLDOWN_SECONDS=60
# Preferred provider for production (HTTP, works on Render free tier)
RESEND_API_KEY=
RESEND_FROM_EMAIL=
RESEND_API_URL=https://api.resend.com/emails
# SMTP fallback (local/dev or paid hosting with SMTP egress)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=no-reply@morius.local
SMTP_FROM_NAME=MoRius
SMTP_USE_TLS=true
SMTP_USE_SSL=false
AVATAR_MAX_BYTES=2097152
YOOKASSA_SHOP_ID=
YOOKASSA_SECRET_KEY=
YOOKASSA_API_URL=https://api.yookassa.ru/v3
PAYMENTS_RETURN_URL=https://your-frontend-domain/dashboard
YOOKASSA_WEBHOOK_TOKEN=
YOOKASSA_WEBHOOK_TRUSTED_IPS_ONLY=false
YOOKASSA_RECEIPT_ENABLED=false
# Optional: 1..6 (0 means "do not send tax_system_code")
YOOKASSA_RECEIPT_TAX_SYSTEM_CODE=0
# 1..6
YOOKASSA_RECEIPT_VAT_CODE=1
YOOKASSA_RECEIPT_PAYMENT_MODE=full_payment
YOOKASSA_RECEIPT_PAYMENT_SUBJECT=service
# Story text generation provider: openrouter | gigachat | mock
STORY_LLM_PROVIDER=openrouter
# GigaChat provider settings (used when STORY_LLM_PROVIDER=gigachat)
GIGACHAT_AUTHORIZATION_KEY=
GIGACHAT_SCOPE=GIGACHAT_API_PERS
GIGACHAT_OAUTH_URL=https://ngw.devices.sberbank.ru:9443/api/v2/oauth
GIGACHAT_CHAT_URL=https://gigachat.devices.sberbank.ru/api/v1/chat/completions
GIGACHAT_MODEL=GigaChat-2-Lite
GIGACHAT_VERIFY_SSL=true
# OpenRouter provider settings (used when STORY_LLM_PROVIDER=openrouter)
OPENROUTER_API_KEY=
OPENROUTER_CHAT_URL=https://openrouter.ai/api/v1/chat/completions
OPENROUTER_MODEL=z-ai/glm-5
OPENROUTER_WORLD_CARD_MODEL=google/gemma-3-12b-it:free
OPENROUTER_TRANSLATION_MODEL=google/gemma-3-12b-it:free
OPENROUTER_PLOT_CARD_MODEL=google/gemma-3-12b-it:free
OPENROUTER_SITE_URL=
OPENROUTER_APP_NAME=MoRius
